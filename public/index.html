<html>
	<head>
			<title>Scorll</title>
			<link rel="stylesheet" href="dijit/themes/claro/claro.css">
			<link type="text/css" rel="stylesheet" href="/css/main.css" /> 
			<link type="text/css" rel="stylesheet" href="/css/stage.css" /> 
			<script src="/dojo/dojo.js" type="text/javascript" djConfig="parseOnLoad: true"></script>
			<script src="/socket.io/socket.io.js"></script>
	</head>
	<body class="claro">
<script type="text/javascript" language="javascript">
  // <![CDATA[
	dojo.require("dojo.store.Memory");
	dojo.require("dojo.dnd.Source");
	dojo.require("dijit.form.Button");
	dojo.require("dijit.Dialog");
	dojo.require("scorll.content.Content");
	dojo.require("scorll.stage.Stage");
	dojo.require("scorll.asset.AssetManager");
    dojo.require("scorll.net.Server");
	dojo.addOnLoad(
		function() {
		    var server = new scorll.net.Server();
            server.connect();
            dojo.connect(server, "onConnect", function() {
                console.log("We say 'Hi'");
                console.log("We get: ");
                server.send("Hi", function(message) {
                    console.log(message);
                    console.log('Cool...');
                });
            });
			content = new scorll.content.Content();
			var stage = new scorll.stage.Stage({content: content});
			stage.render();
			var assetManager = new scorll.asset.AssetManager();
			for(var type in assetManager.assets) {
				var button = new dijit.form.Button();
				var label = assetManager.assets[type].label;
				button.attr('label',label);
				button.widgetType = type;
				dojo.connect(button,"onClick",function() {
					var form = assetManager.getAssetForm({type: this.widgetType});
					var dialog = new dijit.Dialog();
					form.placeAt(dialog.containerNode);
					dialog.show();
					dojo.connect(form,"onSubmit",function(item) {
						dialog.destroy();
						content.add(item);
					});
					dojo.connect(form,"onCancel",function() {
						dialog.destroy();
					});
					dijit.byId("newAssetDialog").hide();
					});
				button.placeAt(dijit.byId("newAssetDialog").containerNode);
			}
		}
	);
	// ]]>
</script>
	<div id="stage-container">
		<div id="title">
			<h1>Lorem Lorem Lorem</h1>
		</div>
		<div id="stage">
		</div>
		<div>
			<div dojoType="dijit.form.Button">Add New Asset
				<script type="dojo/connect" event="onClick" args="evt">
					dijit.byId("newAssetDialog").show();
				</script>
			</div>
		</div>
	</div>
	<div id="newAssetDialog" dojoType="dijit.Dialog" title="Add New Asset" style="width: 300px;">
	</div>
	</body>
</html>
